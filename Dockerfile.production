FROM node:14-alpine

WORKDIR /app

ENV PATH /app/node_modules/.bin:$PATH

ARG REACT_APP_BACKEND_WEBSOCKET_URL
ENV REACT_APP_BACKEND_WEBSOCKET_URL=$REACT_APP_BACKEND_WEBSOCKET_URL

ARG REACT_APP_BACKEND_API_URL
ENV REACT_APP_BACKEND_API_URL=$REACT_APP_BACKEND_API_URL

COPY package.json yarn.lock /app/

RUN npm install -g serve

RUN yarn install

COPY ./ /app/

RUN yarn run build